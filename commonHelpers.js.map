{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst options = {\n  key: '44940230-793e0fb44ed42533ed2f4cfc1',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: 'true',\n  per_page: 15,\n};\n\nexport async function onSearchPhotoFromText(query, page = 1) {\n  const URL = `https://pixabay.com/api/?key=${options.key}&q=${query}&image_type=${options.image_type}&orientation=${options.orientation}&safesearch=${options.safesearch}&per_page=${options.per_page}&page=${page}`;\n\n  try {\n    const res = await axios.get(URL);\n    return res.data;\n  } catch (error) {\n    throw new Error(error.response.status);\n  }\n}\n\nexport function OnShowError() {\n  iziToast.error({\n    title: 'Error',\n    backgroundColor: '#ef4040',\n    message: 'Sorry, there are no images matching your search query. Please, try again!',\n    messageColor: '#fff',\n    messageSize: '16px',\n    position: 'topRight',\n  });\n}\n","\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst allGallery = document.querySelector('.js-markup-list');\n\n\nlet userDataLog = new SimpleLightbox('.js-markup-list a', {\n  captions: true,\n  captionType: 'attr',\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n});\n\nexport function onCreateMarkup(photo) {\n  return photo.map(\n    ({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\n\n\n      return `\n        <li class=\"gallery-item\">\n          <div class=\"list\">\n            <a class=\"gallery-link\" href=\"${largeImageURL}\">\n              <img\n                class=\"gallery-image\"\n                src=\"${webformatURL}\" \n                alt=\"${tags}\"\n              />\n            </a>\n            <ul class=\"adds-list\">\n              <li class=\"info-item\">\n                <p class=\"text-item text-item-name\">Likes</p>\n                <p class=\"text-item\">${likes}</p>\n              </li>\n              <li class=\"info-item\">\n                <p class=\"text-item text-item-name\">Views</p>\n                <p class=\"text-item\">${views}</p>\n              </li>\n              <li class=\"info-item\">\n                <p class=\"text-item text-item-name\">Comments</p>\n                <p class=\"text-item\">${comments}</p>\n              </li>\n              <li class=\"info-item\">\n                <p class=\"text-item text-item-name\">Downloads</p>\n                <p class=\"text-item\">${downloads}</p>\n              </li>\n            </ul>\n          </div>\n        </li>`;\n    }\n  ).join('');\n}\n\nexport function onCreateGalleryPhoto(data) {\n  allGallery.insertAdjacentHTML('beforeend', onCreateMarkup(data.hits));\n  userDataLog.refresh();\n  scrollPage();\n}\n\nexport function clearGallery() {\n  allGallery.innerHTML = '';\n}\n\nconst scrollPage = async () => {\n  const galleryItem = document.querySelector('.gallery-item');\n  if (galleryItem) {\n    const { height } = galleryItem.getBoundingClientRect();\n    window.scrollBy({\n      top: height * 2,\n      behavior: 'smooth',\n    });\n  }\n}","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { OnShowError, onSearchPhotoFromText } from './js/pixabay-api';\nimport { onCreateGalleryPhoto, clearGallery } from './js/render-functions';\n\nconst cssLoadAnimation = document.querySelector('.loader');\nconst inputQuery = document.querySelector('.my-input');\nconst btnSbm = document.querySelector('.form-btn');\nconst loadMoreBtn = document.querySelector('.load-more-btn');\n\nlet pages = 1;\nlet queryData = '';\n\nloadMoreBtn.addEventListener('click', async () => {\n  pages += 1;\n  await loadMorePhotos();\n});\n\nbtnSbm.addEventListener('click', async (evt) => {\n  evt.preventDefault();\n  cssLoadAnimation.style.display = 'inline-block';\n\n  queryData = inputQuery.value.trim().replace(/\\s+/g, '+').toLowerCase();\n\n  if (queryData === \"\") {\n    cssLoadAnimation.style.display = 'none';\n    // loadMoreBtn.style.display = 'inline-block,';\n    clearGallery();\n    iziToast.error({\n      title: 'Error',\n      backgroundColor: '#ef4040',\n      message: 'Please enter a valid search query.',\n      messageColor: '#fff',\n      messageSize: '16px',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  pages = 1;  // Reset pages for a new search\n  await searchPhotos();\n});\n\nasync function searchPhotos() {\n  try {\n    const data = await onSearchPhotoFromText(queryData, pages);\n    cssLoadAnimation.style.display = 'none';\n    clearGallery();\n\n    if (data.totalHits === 0) {\n      OnShowError();\n      loadMoreBtn.style.display = 'none';\n    } else {\n      onCreateGalleryPhoto(data);\n      handleLoadMoreButtonVisibility(data);\n    }\n  } catch (error) {\n    OnShowError();\n  } finally {\n    inputQuery.value = '';\n  }\n}\n\nasync function loadMorePhotos() {\n  try {\n    const data = await onSearchPhotoFromText(queryData, pages);\n    onCreateGalleryPhoto(data);\n    handleLoadMoreButtonVisibility(data);\n  } catch (error) {\n    OnShowError();\n  }\n}\n\nfunction handleLoadMoreButtonVisibility(data) {\n  const totalPages = Math.ceil(data.totalHits / 15);\n\n  if (pages >= totalPages) {\n    loadMoreBtn.style.display = 'none';\n    iziToast.info({\n      title: 'Info',\n      backgroundColor: '#f39c12',\n      message: \"We're sorry, but you've reached the end of search results.\",\n      messageColor: '#fff',\n      messageSize: '16px',\n      position: 'topRight',\n    });\n  } else {\n    loadMoreBtn.style.display = 'inline-block';\n  }\n}\n"],"names":["options","onSearchPhotoFromText","query","page","URL","axios","error","OnShowError","iziToast","allGallery","userDataLog","SimpleLightbox","onCreateMarkup","photo","webformatURL","largeImageURL","tags","likes","views","comments","downloads","onCreateGalleryPhoto","data","scrollPage","clearGallery","galleryItem","height","cssLoadAnimation","inputQuery","btnSbm","loadMoreBtn","pages","queryData","loadMorePhotos","evt","searchPhotos","handleLoadMoreButtonVisibility","totalPages"],"mappings":"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"}